# AI导入功能测试指南

## 🎯 测试目标

验证AI智能导入功能的完整工作流程，确保：
1. 原始题库正确备份到只读目录
2. 解析规则正确保存到config
3. 基础题库正确生成
4. 出题模式规律正确生成

## 📋 测试准备

### 1. 准备测试数据

创建测试题库文件夹，包含几个Markdown文件：

**测试文件夹结构**:
```
测试题库/
├── 考试一.md
├── 考试二.md
└── 考试三.md
```

**示例题目文件** (`考试一.md`):
```markdown
# 第1题：两数之和

## 题目描述
给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那两个整数，并返回他们的数组下标。

## 输入格式
第一行：数组元素，用空格分隔
第二行：目标值

## 输出格式
两个下标，用空格分隔

## 测试用例1
输入：
2 7 11 15
9

输出：
0 1

## 测试用例2
输入：
3 2 4
6

输出：
1 2

---

# 第2题：反转字符串

## 题目描述
编写一个函数，其作用是将输入的字符串反转过来。

## 输入格式
一行字符串

## 输出格式
反转后的字符串

## 测试用例1
输入：
hello

输出：
olleh
```

### 2. 启动程序

```bash
# 运行程序
.\build\CodePracticeSystem.exe
```

## 🧪 测试步骤

### 步骤1: 启动AI导入

1. 点击主界面的 **"🤖 AI导入题库"** 按钮
2. 在弹出的对话框中：
   - 选择准备好的测试题库文件夹
   - 输入题库名称：`测试CCF`
   - 点击"开始导入"

### 步骤2: 观察导入过程

导入对话框应该显示以下步骤：

```
🚀 开始智能导入流程...

📁 第一步：备份原始题库文件...
  找到 3 个文件
  ✓ 考试一.md
  ✓ 考试二.md
  ✓ 考试三.md
✅ 原始题库已备份到: data/原始题库/测试CCF
🔒 原始题库已设置为只读

📂 第二步：扫描和分析文件...
  分析: 考试一.md (XXX 字符)
  分析: 考试二.md (XXX 字符)
  分析: 考试三.md (XXX 字符)
✅ 文件分析完成，共 X 个文件块

🤖 第三步：AI智能解析题目...
📄 处理: 考试一.md (块 1/1)
  ⏳ 发送AI请求...
  📊 Prompt大小: XXX 字符
  ✓ AI响应接收完成
  ✓ 解析到 X 道题目
    ✓ 两数之和 [简单] - 5个测试用例
    ✓ 反转字符串 [简单] - 5个测试用例

✅ AI解析完成！共导入 X 道题目

📝 第四步：保存解析规则和基础题库...
  ✓ 解析规则已保存: data/config/ccf_parse_rule.json
  📁 基础题库目录: data/基础题库/测试CCF
  ✓ 考试一: 保存 X 道题目
  ✓ 考试二: 保存 X 道题目
  ✓ 考试三: 保存 X 道题目
  ✅ 共保存 X 道题目到基础题库
✅ 解析规则和基础题库保存完成

📊 第五步：生成出题模式规律...
  ✓ 出题模式规律已保存: data/基础题库/测试CCF/出题模式规律.md
✅ 出题模式规律生成完成

🎉 导入完成！
```

### 步骤3: 验证文件结构

检查以下目录和文件是否正确生成：

#### 3.1 原始题库（只读备份）

```bash
# 检查原始题库目录
dir data\原始题库\测试CCF
```

**预期结果**:
- 包含所有原始 `.md` 文件
- 文件为只读属性

**验证命令**:
```powershell
# 检查文件属性
Get-ItemProperty data\原始题库\测试CCF\*.md | Select-Object Name, IsReadOnly
```

#### 3.2 解析规则

```bash
# 查看解析规则
type data\config\ccf_parse_rule.json
```

**预期内容**:
```json
{
  "bankName": "测试CCF",
  "totalQuestions": 6,
  "createdTime": "2024-12-03T...",
  "modulePatterns": [
    {
      "题干标识": ["【题目描述】", "问题：", "题目："],
      "输入标识": ["【输入】", "输入格式：", "Input:"],
      "输出标识": ["【输出】", "输出格式：", "Output:"],
      "测试数据分隔": ["空行", "测试用例", "样例"],
      "代码限制": ["【时间限制】", "【内存限制】", "支持语言："]
    }
  ],
  "parseMode": "AI智能解析"
}
```

#### 3.3 基础题库

```bash
# 检查基础题库目录结构
tree /F data\基础题库\测试CCF
```

**预期结构**:
```
data\基础题库\测试CCF\
├── 考试一\
│   ├── 第1题.md
│   ├── 第2题.md
│   └── ...
├── 考试二\
│   ├── 第1题.md
│   └── ...
├── 考试三\
│   └── ...
└── 出题模式规律.md
```

#### 3.4 题目文件内容

```bash
# 查看某道题目
type "data\基础题库\测试CCF\考试一\第1题.md"
```

**预期格式**:
```markdown
# 两数之和

## 题目描述

给定一个整数数组 nums 和一个目标值 target...

## 测试数据

### 测试用例 1 - 基本功能 (原始数据)

**输入：**
```
2 7 11 15
9
```

**输出：**
```
0 1
```

### 测试用例 2 - 边界条件 (AI补充)

**输入：**
```
...
```

**输出：**
```
...
```

## 题目信息

- **难度**: 简单
- **标签**: 数组, 哈希表
```

#### 3.5 出题模式规律

```bash
# 查看出题模式规律
type "data\基础题库\测试CCF\出题模式规律.md"
```

**预期内容**:
```markdown
# 测试CCF - 出题模式规律

> 自动生成时间: 2024-12-03 ...

## 📊 题库概况

- **题目总数**: 6 道
- **平均测试用例**: 5.0 组/题

## 📈 难度分布

| 难度 | 数量 | 占比 |
|------|------|------|
| 简单 | 4 | 67% |
| 中等 | 2 | 33% |
| 困难 | 0 | 0% |

## 🏷️ 知识点分布

| 知识点 | 题目数 |
|--------|--------|
| 数组 | 2 |
| 字符串 | 2 |
| ...

## 📋 出题规则

### 套题数量
- 每套题目数量: 6 道

### 难度配比建议
- 简单题: 67%
- 中等题: 33%
- 困难题: 0%

### 测试数据规则
- 每题至少 3 组原始测试数据
- AI自动补充 2-3 组边界/异常测试数据
- 测试数据覆盖：基本功能、边界条件、特殊情况
```

## ✅ 验证清单

完成测试后，勾选以下项目：

### 文件存在性
- [ ] `data/原始题库/测试CCF/` 目录存在
- [ ] 原始题库包含所有 `.md` 文件
- [ ] 原始题库文件为只读
- [ ] `data/config/ccf_parse_rule.json` 存在
- [ ] `data/基础题库/测试CCF/` 目录存在
- [ ] 基础题库包含所有考试文件夹
- [ ] 每个考试文件夹包含题目文件
- [ ] `出题模式规律.md` 存在

### 内容正确性
- [ ] 解析规则JSON格式正确
- [ ] 解析规则包含所有必要字段
- [ ] 题目文件格式符合标准
- [ ] 题目包含完整的描述和测试数据
- [ ] 测试数据标注了原始/AI补充
- [ ] 题目信息包含难度和标签
- [ ] 出题模式规律包含完整统计

### 功能正确性
- [ ] AI成功解析所有题目
- [ ] 测试用例数量 ≥ 5 组
- [ ] 难度分类正确
- [ ] 知识点标签合理
- [ ] 统计数据准确

## 🐛 常见问题

### 问题1: AI解析失败

**症状**: 日志显示"AI错误"或"JSON解析失败"

**可能原因**:
- Ollama服务未启动
- AI模型未安装
- 网络连接问题

**解决方法**:
```bash
# 检查Ollama服务
ollama list

# 启动Ollama
ollama serve

# 测试模型
ollama run qwen2.5-coder:7b "测试"
```

### 问题2: 文件未保存

**症状**: 目录为空或文件缺失

**可能原因**:
- 权限不足
- 磁盘空间不足
- 路径错误

**解决方法**:
```bash
# 检查磁盘空间
dir

# 检查目录权限
icacls data

# 手动创建目录
mkdir data\原始题库
mkdir data\基础题库
mkdir data\config
```

### 问题3: 只读属性未设置

**症状**: 原始题库文件可以修改

**解决方法**:
```powershell
# 手动设置只读
Get-ChildItem data\原始题库\测试CCF\*.md | ForEach-Object { $_.IsReadOnly = $true }
```

## 📊 性能测试

### 测试场景1: 小型题库（10道题）

- **文件数**: 2个
- **总字符数**: ~20,000
- **预期时间**: 30-60秒
- **内存占用**: < 100MB

### 测试场景2: 中型题库（50道题）

- **文件数**: 5个
- **总字符数**: ~100,000
- **预期时间**: 2-5分钟
- **内存占用**: < 200MB

### 测试场景3: 大型题库（100道题）

- **文件数**: 10个
- **总字符数**: ~200,000
- **预期时间**: 5-10分钟
- **内存占用**: < 300MB

## 🎓 测试报告模板

```markdown
# AI导入功能测试报告

**测试日期**: 2024-12-03
**测试人员**: [姓名]
**版本**: v2.0.1

## 测试环境
- 操作系统: Windows 11
- AI模型: qwen2.5-coder:7b
- 题库规模: 10道题

## 测试结果

### 功能测试
- [x] 原始题库备份: ✅ 通过
- [x] 解析规则生成: ✅ 通过
- [x] 基础题库生成: ✅ 通过
- [x] 出题模式规律: ✅ 通过

### 性能测试
- 导入时间: 45秒
- 内存占用: 85MB
- CPU占用: 平均30%

### 问题记录
1. 无

## 结论
✅ 所有功能正常，可以发布
```

---

**测试版本**: v2.0.1  
**更新时间**: 2024-12-03  
**状态**: ✅ 测试通过
