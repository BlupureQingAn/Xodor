# 应用程序图标设置说明

## 图标设计

已创建酒红色与灰色主题的X字母图标：
- **主色调**：酒红色 (#660000, #880000, #aa0000)
- **辅助色**：深灰色 (#2d2d2d)
- **设计元素**：
  - 圆形背景（深灰色）
  - 酒红色渐变外圈
  - 粗线条X字母（酒红色渐变）
  - 中心高光点
  - 阴影效果

## 文件位置

- **SVG源文件**：`resources/icon.svg`
- **PNG图标**：`resources/icon.png` (256x256)
- **ICO图标**：`resources/icon.ico` (多尺寸: 16, 32, 48, 64, 128, 256)
- **资源文件**：`resources/app_icon.rc`

## 创建图标的方法

### 方法1：使用 Python 脚本（推荐）

```bash
# 安装依赖
pip install pillow cairosvg

# 运行脚本
python create_icon.py
```

### 方法2：使用 PowerShell 脚本

需要安装 Inkscape 或 ImageMagick：
- Inkscape: https://inkscape.org/release/
- ImageMagick: https://imagemagick.org/script/download.php

```powershell
powershell -ExecutionPolicy Bypass -File create_icon.ps1
```

### 方法3：使用批处理文件（交互式）

```bash
create_icon_simple.bat
```

这个脚本会提供多个选项，包括在线转换工具。

### 方法4：手动转换

1. 打开 `resources/icon.svg`
2. 使用在线工具转换：
   - SVG → PNG: https://convertio.co/zh/svg-png/
   - PNG → ICO: https://convertio.co/zh/png-ico/
3. 保存文件：
   - `resources/icon.png` (256x256)
   - `resources/icon.ico` (包含多个尺寸)

### 方法5：使用 GIMP

1. 用 GIMP 打开 `resources/icon.svg`
2. 图像 → 缩放图像 → 256x256
3. 文件 → 导出为 → `icon.png`
4. 文件 → 导出为 → `icon.ico` (选择多个尺寸)

## CMake 配置

已在 `CMakeLists.txt` 中配置：

```cmake
# Windows 资源文件（图标）
if(WIN32)
    set(APP_ICON_RC "${CMAKE_SOURCE_DIR}/resources/app_icon.rc")
endif()

# 创建可执行文件
if(WIN32)
    add_executable(${PROJECT_NAME} WIN32 ${SOURCES} ${HEADERS} ${APP_ICON_RC})
else()
    add_executable(${PROJECT_NAME} ${SOURCES} ${HEADERS})
endif()
```

## 编译步骤

1. **创建图标文件**（选择一个方法）：
   ```bash
   python create_icon.py
   # 或
   create_icon_simple.bat
   ```

2. **确认文件存在**：
   - `resources/icon.png` ✓
   - `resources/icon.ico` ✓

3. **重新配置 CMake**：
   ```bash
   cmake -B build -G "Ninja" -DCMAKE_PREFIX_PATH=F:/Qt/6.9.2/mingw_64
   ```

4. **编译项目**：
   ```bash
   cmake --build build --target CodePracticeSystem
   ```

5. **验证图标**：
   - 检查 `build/CodePracticeSystem.exe` 的图标
   - 在文件资源管理器中查看
   - 运行程序，查看任务栏图标

## 部署

编译后，图标会自动嵌入到 EXE 文件中。部署时：

1. **Debug 版本**：
   ```bash
   deploy_debug_manual.bat
   ```

2. **Release 版本**：
   ```bash
   deploy_windows.bat
   ```

图标会随 EXE 文件一起部署，无需额外复制图标文件。

## 故障排除

### 问题1：图标未显示

**原因**：ICO 文件不存在或格式错误

**解决**：
1. 确认 `resources/icon.ico` 存在
2. 使用工具验证 ICO 文件格式
3. 重新生成 ICO 文件

### 问题2：编译错误 "cannot find app_icon.rc"

**原因**：资源文件路径错误

**解决**：
1. 确认 `resources/app_icon.rc` 存在
2. 检查 CMakeLists.txt 中的路径
3. 重新配置 CMake

### 问题3：图标模糊或失真

**原因**：ICO 文件缺少多个尺寸

**解决**：
1. 重新生成 ICO，包含所有尺寸 (16, 32, 48, 64, 128, 256)
2. 使用高质量的转换工具

### 问题4：Python 脚本失败

**原因**：缺少依赖库

**解决**：
```bash
pip install --upgrade pillow cairosvg
```

如果 cairosvg 安装失败（Windows），尝试：
```bash
pip install pillow
# 然后使用在线工具或其他方法转换 SVG
```

## 自定义图标

如果需要修改图标设计：

1. **编辑 SVG**：
   - 使用 Inkscape、Adobe Illustrator 或在线编辑器
   - 文件：`resources/icon.svg`

2. **修改颜色**：
   ```svg
   <!-- 酒红色渐变 -->
   <stop offset="0%" style="stop-color:#880000;stop-opacity:1" />
   <stop offset="100%" style="stop-color:#660000;stop-opacity:1" />
   
   <!-- 深灰色背景 -->
   <circle cx="128" cy="128" r="120" fill="#2d2d2d"/>
   ```

3. **重新生成**：
   ```bash
   python create_icon.py
   ```

4. **重新编译**：
   ```bash
   cmake --build build --target CodePracticeSystem
   ```

## 技术细节

### 资源文件格式 (app_icon.rc)

```rc
IDI_ICON1 ICON DISCARDABLE "icon.ico"
```

- `IDI_ICON1`：资源标识符
- `ICON`：资源类型
- `DISCARDABLE`：可丢弃（节省内存）
- `"icon.ico"`：图标文件路径（相对于 .rc 文件）

### ICO 文件结构

ICO 文件应包含多个尺寸：
- 16x16：任务栏小图标
- 32x32：文件资源管理器
- 48x48：大图标视图
- 64x64：高 DPI 显示
- 128x128：超高 DPI
- 256x256：最高质量

### Windows 图标缓存

如果图标未更新：
1. 清除图标缓存：
   ```cmd
   ie4uinit.exe -show
   ```
2. 重启文件资源管理器
3. 重新编译程序

## 相关文件

- `resources/icon.svg` - SVG 源文件
- `resources/icon.png` - PNG 图标
- `resources/icon.ico` - ICO 图标
- `resources/app_icon.rc` - Windows 资源文件
- `create_icon.py` - Python 转换脚本
- `create_icon.ps1` - PowerShell 转换脚本
- `create_icon_simple.bat` - 交互式批处理
- `CMakeLists.txt` - CMake 配置

## 完成时间

2026-01-07
