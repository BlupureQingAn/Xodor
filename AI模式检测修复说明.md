# AIæ¨¡å¼æ£€æµ‹ä¿®å¤è¯´æ˜

## é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆï¼š"æˆ‘æ˜æ˜åˆ‡æ¢åˆ°æœ¬åœ°AIäº†æ£€æµ‹é€»è¾‘æ²¡å˜"

## é—®é¢˜æ ¹æº

### åŸå§‹æ£€æµ‹é€»è¾‘çš„é—®é¢˜

```cpp
void MainWindow::showAIConnectionStatus(const AIConnectionStatus &status)
{
    if (status.ollamaAvailable) {
        // Ollamaè¿æ¥æˆåŠŸ â†’ æ˜¾ç¤ºOllama
        statusMessage = QString("âœ… AIæœåŠ¡å·²è¿æ¥ - Ollama (%1)").arg(status.ollamaModel);
        
    } else if (status.cloudApiAvailable) {
        // äº‘ç«¯APIè¿æ¥æˆåŠŸ â†’ æ˜¾ç¤ºäº‘ç«¯API
        statusMessage = "âœ… AIæœåŠ¡å·²è¿æ¥ - äº‘ç«¯API";
        
    } else {
        // ä¸¤è€…éƒ½ä¸å¯ç”¨ â†’ æ˜¾ç¤ºæœªè¿æ¥
        statusMessage = "âš ï¸ AIæœåŠ¡æœªè¿æ¥";
    }
}
```

**é—®é¢˜æ‰€åœ¨**ï¼š

1. **æ²¡æœ‰è€ƒè™‘ç”¨æˆ·çš„é€‰æ‹©** âŒ
   - æ£€æµ‹é€»è¾‘æ€»æ˜¯ä¼˜å…ˆæ˜¾ç¤ºOllama
   - å³ä½¿ç”¨æˆ·é€‰æ‹©äº†äº‘ç«¯APIï¼Œå¦‚æœOllamaå¯ç”¨ï¼Œä¹Ÿä¼šæ˜¾ç¤ºOllama
   - ç”¨æˆ·åˆ‡æ¢æ¨¡å¼åï¼Œæ˜¾ç¤ºçš„çŠ¶æ€ä¸å˜

2. **æ˜¾ç¤ºä¼˜å…ˆçº§å›ºå®š** âŒ
   - ä¼˜å…ˆçº§ï¼šOllama > äº‘ç«¯API > æœªè¿æ¥
   - ä¸ç®¡ç”¨æˆ·å®é™…é€‰æ‹©äº†ä»€ä¹ˆæ¨¡å¼

3. **ç”¨æˆ·å›°æƒ‘** âŒ
   - ç”¨æˆ·åˆ‡æ¢åˆ°äº‘ç«¯APIï¼Œä½†æ˜¾ç¤º"Ollamaå·²è¿æ¥"
   - ç”¨æˆ·åˆ‡æ¢åˆ°æœ¬åœ°Ollamaï¼Œä½†æ˜¾ç¤º"äº‘ç«¯APIå·²è¿æ¥"
   - ä¸çŸ¥é“å½“å‰å®é™…ä½¿ç”¨çš„æ˜¯å“ªä¸ª

### å®é™…åœºæ™¯

**åœºæ™¯1ï¼šç”¨æˆ·é…ç½®äº†ä¸¤è€…ï¼Œé€‰æ‹©äº‘ç«¯API**
```
é…ç½®ï¼š
- Ollama: å·²å®‰è£…ï¼Œqwen2.5:7b å¯ç”¨
- äº‘ç«¯API: å·²é…ç½®ï¼ŒAPI Keyæœ‰æ•ˆ
- ç”¨æˆ·é€‰æ‹©: äº‘ç«¯API âœ…

æ£€æµ‹ç»“æœï¼š
- status.ollamaAvailable = true
- status.cloudApiAvailable = true

æ˜¾ç¤ºï¼š
"âœ… AIæœåŠ¡å·²è¿æ¥ - Ollama (qwen2.5:7b)" âŒ

é—®é¢˜ï¼šç”¨æˆ·é€‰æ‹©äº†äº‘ç«¯APIï¼Œä½†æ˜¾ç¤ºçš„æ˜¯Ollamaï¼
```

**åœºæ™¯2ï¼šç”¨æˆ·é…ç½®äº†ä¸¤è€…ï¼Œé€‰æ‹©æœ¬åœ°Ollama**
```
é…ç½®ï¼š
- Ollama: å·²å®‰è£…ï¼Œqwen2.5:7b å¯ç”¨
- äº‘ç«¯API: å·²é…ç½®ï¼ŒAPI Keyæœ‰æ•ˆ
- ç”¨æˆ·é€‰æ‹©: æœ¬åœ°Ollama âœ…

æ£€æµ‹ç»“æœï¼š
- status.ollamaAvailable = true
- status.cloudApiAvailable = true

æ˜¾ç¤ºï¼š
"âœ… AIæœåŠ¡å·²è¿æ¥ - Ollama (qwen2.5:7b)" âœ…

é—®é¢˜ï¼šè¿™æ¬¡æ˜¯å¯¹çš„ï¼Œä½†åªæ˜¯ç¢°å·§ï¼
```

## è§£å†³æ–¹æ¡ˆ

### æ ¹æ®ç”¨æˆ·é€‰æ‹©æ˜¾ç¤ºçŠ¶æ€

**æ ¸å¿ƒæ€æƒ³**ï¼šæ£€æŸ¥ç”¨æˆ·å½“å‰é€‰æ‹©çš„æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå¯¹åº”æ¨¡å¼çš„çŠ¶æ€

```cpp
void MainWindow::showAIConnectionStatus(const AIConnectionStatus &status)
{
    // ä¿å­˜çŠ¶æ€ä¾›åç»­ä½¿ç”¨
    m_lastAIStatus = status;
    
    // åˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºé…ç½®å¯¹è¯æ¡†
    bool needConfig = false;
    QString statusMessage;
    
    // âœ… è·å–ç”¨æˆ·å½“å‰é€‰æ‹©çš„æ¨¡å¼
    ConfigManager &config = ConfigManager::instance();
    bool useCloudApi = config.useCloudApi();
    
    // âœ… æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„æ¨¡å¼æ˜¾ç¤ºå¯¹åº”çš„çŠ¶æ€
    if (useCloudApi) {
        // ç”¨æˆ·é€‰æ‹©äº†äº‘ç«¯APIæ¨¡å¼
        if (status.cloudApiAvailable) {
            statusMessage = "âœ… AIæœåŠ¡å·²è¿æ¥ - äº‘ç«¯API";
            statusBar()->showMessage(statusMessage, 5000);
            qInfo() << "AIè¿æ¥æ£€æµ‹ï¼šäº‘ç«¯APIå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰";
        } else {
            // äº‘ç«¯APIä¸å¯ç”¨
            needConfig = true;
            statusMessage = "âš ï¸ äº‘ç«¯APIæœªé…ç½®æˆ–è¿æ¥å¤±è´¥";
            statusBar()->showMessage(statusMessage, 0);
            qWarning() << "AIè¿æ¥æ£€æµ‹ï¼šäº‘ç«¯APIä¸å¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰";
            qWarning() << "  é”™è¯¯:" << status.cloudApiError;
        }
    } else {
        // ç”¨æˆ·é€‰æ‹©äº†æœ¬åœ°Ollamaæ¨¡å¼
        if (status.ollamaAvailable) {
            statusMessage = QString("âœ… AIæœåŠ¡å·²è¿æ¥ - Ollama (%1)").arg(status.ollamaModel);
            statusBar()->showMessage(statusMessage, 5000);
            qInfo() << "AIè¿æ¥æ£€æµ‹ï¼šOllamaå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰ -" << status.ollamaModel;
        } else {
            // Ollamaä¸å¯ç”¨
            needConfig = true;
            
            // æ ¹æ®å…·ä½“æƒ…å†µæ˜¾ç¤ºä¸åŒçš„æç¤º
            if (status.needModelSelection && !status.availableModels.isEmpty()) {
                statusMessage = QString("âš ï¸ é…ç½®çš„AIæ¨¡å‹ä¸å¯ç”¨ï¼Œä½†æ£€æµ‹åˆ° %1 ä¸ªå…¶ä»–æ¨¡å‹")
                    .arg(status.availableModels.size());
            } else {
                statusMessage = "âš ï¸ Ollamaæœªè¿æ¥æˆ–æœªé…ç½®";
            }
            
            statusBar()->showMessage(statusMessage, 0);
            qWarning() << "AIè¿æ¥æ£€æµ‹ï¼šOllamaä¸å¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰";
            qWarning() << "  é”™è¯¯:" << status.ollamaError;
        }
    }
    
    // åªåœ¨éœ€è¦é…ç½®æ—¶æ‰å¼¹çª—
    if (needConfig) {
        QTimer::singleShot(100, this, [this, status]() {
            showAIConfigDialog(status);
        });
    }
}
```

### å…³é”®æ”¹è¿›

1. **è¯»å–ç”¨æˆ·é€‰æ‹©** âœ…
   ```cpp
   ConfigManager &config = ConfigManager::instance();
   bool useCloudApi = config.useCloudApi();
   ```

2. **åˆ†æ”¯åˆ¤æ–­** âœ…
   ```cpp
   if (useCloudApi) {
       // åªæ£€æŸ¥äº‘ç«¯APIçŠ¶æ€
   } else {
       // åªæ£€æŸ¥OllamaçŠ¶æ€
   }
   ```

3. **æ˜ç¡®çš„æ—¥å¿—** âœ…
   ```cpp
   qInfo() << "AIè¿æ¥æ£€æµ‹ï¼šäº‘ç«¯APIå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰";
   qInfo() << "AIè¿æ¥æ£€æµ‹ï¼šOllamaå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰";
   ```

## æ£€æµ‹æµç¨‹å¯¹æ¯”

### ä¿®å¤å‰ âŒ

```
å¯åŠ¨ç¨‹åº
  â†“
æ£€æµ‹AIè¿æ¥
  â†“
Ollamaå¯ç”¨ï¼Ÿ
  â”œâ”€ æ˜¯ â†’ æ˜¾ç¤º"Ollamaå·²è¿æ¥" âŒï¼ˆä¸ç®¡ç”¨æˆ·é€‰æ‹©ï¼‰
  â””â”€ å¦ â†’ äº‘ç«¯APIå¯ç”¨ï¼Ÿ
      â”œâ”€ æ˜¯ â†’ æ˜¾ç¤º"äº‘ç«¯APIå·²è¿æ¥" âŒï¼ˆä¸ç®¡ç”¨æˆ·é€‰æ‹©ï¼‰
      â””â”€ å¦ â†’ æ˜¾ç¤º"æœªè¿æ¥"
```

**é—®é¢˜**ï¼š
- æ€»æ˜¯ä¼˜å…ˆæ˜¾ç¤ºOllama
- ä¸è€ƒè™‘ç”¨æˆ·çš„å®é™…é€‰æ‹©
- æ˜¾ç¤ºä¸å®é™…ä½¿ç”¨ä¸ç¬¦

### ä¿®å¤å âœ…

```
å¯åŠ¨ç¨‹åº
  â†“
æ£€æµ‹AIè¿æ¥
  â†“
ç”¨æˆ·é€‰æ‹©äº†äº‘ç«¯APIï¼Ÿ
  â”œâ”€ æ˜¯ â†’ äº‘ç«¯APIå¯ç”¨ï¼Ÿ
  â”‚   â”œâ”€ æ˜¯ â†’ æ˜¾ç¤º"äº‘ç«¯APIå·²è¿æ¥" âœ…
  â”‚   â””â”€ å¦ â†’ æ˜¾ç¤º"äº‘ç«¯APIæœªé…ç½®" âš ï¸
  â”‚
  â””â”€ å¦ï¼ˆæœ¬åœ°Ollamaï¼‰â†’ Ollamaå¯ç”¨ï¼Ÿ
      â”œâ”€ æ˜¯ â†’ æ˜¾ç¤º"Ollamaå·²è¿æ¥" âœ…
      â””â”€ å¦ â†’ æ˜¾ç¤º"Ollamaæœªè¿æ¥" âš ï¸
```

**ä¼˜ç‚¹**ï¼š
- æ ¹æ®ç”¨æˆ·é€‰æ‹©æ˜¾ç¤ºçŠ¶æ€
- æ˜¾ç¤ºä¸å®é™…ä½¿ç”¨ä¸€è‡´
- ç”¨æˆ·æ¸…æ¥šçŸ¥é“å½“å‰ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆ

## æµ‹è¯•åœºæ™¯

### åœºæ™¯1ï¼šé…ç½®äº†ä¸¤è€…ï¼Œé€‰æ‹©äº‘ç«¯API

**é…ç½®**ï¼š
- Ollama: å·²å®‰è£…ï¼Œqwen2.5:7b å¯ç”¨
- äº‘ç«¯API: å·²é…ç½®ï¼ŒAPI Keyæœ‰æ•ˆ
- ç”¨æˆ·é€‰æ‹©: äº‘ç«¯API âœ…

**æ“ä½œ**ï¼š
1. åœ¨è®¾ç½®ä¸­é€‰æ‹©"ä½¿ç”¨äº‘ç«¯API"
2. å¯åŠ¨ç¨‹åº

**é¢„æœŸ**ï¼š
- çŠ¶æ€æ æ˜¾ç¤ºï¼š"âœ… AIæœåŠ¡å·²è¿æ¥ - äº‘ç«¯API" âœ…
- æ—¥å¿—æ˜¾ç¤ºï¼š"AIè¿æ¥æ£€æµ‹ï¼šäº‘ç«¯APIå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰"
- ä¸å¼¹å‡ºé…ç½®çª—å£

### åœºæ™¯2ï¼šé…ç½®äº†ä¸¤è€…ï¼Œé€‰æ‹©æœ¬åœ°Ollama

**é…ç½®**ï¼š
- Ollama: å·²å®‰è£…ï¼Œqwen2.5:7b å¯ç”¨
- äº‘ç«¯API: å·²é…ç½®ï¼ŒAPI Keyæœ‰æ•ˆ
- ç”¨æˆ·é€‰æ‹©: æœ¬åœ°Ollama âœ…

**æ“ä½œ**ï¼š
1. åœ¨è®¾ç½®ä¸­é€‰æ‹©"ä½¿ç”¨æœ¬åœ°Ollama"
2. å¯åŠ¨ç¨‹åº

**é¢„æœŸ**ï¼š
- çŠ¶æ€æ æ˜¾ç¤ºï¼š"âœ… AIæœåŠ¡å·²è¿æ¥ - Ollama (qwen2.5:7b)" âœ…
- æ—¥å¿—æ˜¾ç¤ºï¼š"AIè¿æ¥æ£€æµ‹ï¼šOllamaå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰ - qwen2.5:7b"
- ä¸å¼¹å‡ºé…ç½®çª—å£

### åœºæ™¯3ï¼šé€‰æ‹©äº‘ç«¯APIï¼Œä½†æœªé…ç½®

**é…ç½®**ï¼š
- Ollama: å·²å®‰è£…ï¼Œqwen2.5:7b å¯ç”¨
- äº‘ç«¯API: æœªé…ç½® âŒ
- ç”¨æˆ·é€‰æ‹©: äº‘ç«¯API

**æ“ä½œ**ï¼š
1. åœ¨è®¾ç½®ä¸­é€‰æ‹©"ä½¿ç”¨äº‘ç«¯API"
2. æ¸…ç©ºAPI Key
3. å¯åŠ¨ç¨‹åº

**é¢„æœŸ**ï¼š
- çŠ¶æ€æ æ˜¾ç¤ºï¼š"âš ï¸ äº‘ç«¯APIæœªé…ç½®æˆ–è¿æ¥å¤±è´¥" âš ï¸
- æ—¥å¿—æ˜¾ç¤ºï¼š"AIè¿æ¥æ£€æµ‹ï¼šäº‘ç«¯APIä¸å¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰"
- å¼¹å‡ºé…ç½®çª—å£

### åœºæ™¯4ï¼šé€‰æ‹©æœ¬åœ°Ollamaï¼Œä½†æœªè¿è¡Œ

**é…ç½®**ï¼š
- Ollama: æœªè¿è¡Œ âŒ
- äº‘ç«¯API: å·²é…ç½®ï¼ŒAPI Keyæœ‰æ•ˆ
- ç”¨æˆ·é€‰æ‹©: æœ¬åœ°Ollama

**æ“ä½œ**ï¼š
1. åœ¨è®¾ç½®ä¸­é€‰æ‹©"ä½¿ç”¨æœ¬åœ°Ollama"
2. åœæ­¢OllamaæœåŠ¡
3. å¯åŠ¨ç¨‹åº

**é¢„æœŸ**ï¼š
- çŠ¶æ€æ æ˜¾ç¤ºï¼š"âš ï¸ Ollamaæœªè¿æ¥æˆ–æœªé…ç½®" âš ï¸
- æ—¥å¿—æ˜¾ç¤ºï¼š"AIè¿æ¥æ£€æµ‹ï¼šOllamaä¸å¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰"
- å¼¹å‡ºé…ç½®çª—å£

### åœºæ™¯5ï¼šåˆ‡æ¢æ¨¡å¼

**æ“ä½œ**ï¼š
1. å¯åŠ¨ç¨‹åºï¼ˆä½¿ç”¨äº‘ç«¯APIï¼‰
2. çŠ¶æ€æ æ˜¾ç¤ºï¼š"âœ… AIæœåŠ¡å·²è¿æ¥ - äº‘ç«¯API"
3. æ‰“å¼€è®¾ç½®ï¼Œåˆ‡æ¢åˆ°"ä½¿ç”¨æœ¬åœ°Ollama"
4. ä¿å­˜è®¾ç½®

**é¢„æœŸ**ï¼š
- ä¸‹æ¬¡å¯åŠ¨æ—¶ï¼ŒçŠ¶æ€æ æ˜¾ç¤ºï¼š"âœ… AIæœåŠ¡å·²è¿æ¥ - Ollama (qwen2.5:7b)" âœ…
- æ˜¾ç¤ºä¸ç”¨æˆ·é€‰æ‹©ä¸€è‡´

## æ—¥å¿—è¾“å‡ºç¤ºä¾‹

### äº‘ç«¯APIæ¨¡å¼ï¼ˆå¯ç”¨ï¼‰
```
[INFO] AIè¿æ¥æ£€æµ‹ï¼šäº‘ç«¯APIå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰
```

### äº‘ç«¯APIæ¨¡å¼ï¼ˆä¸å¯ç”¨ï¼‰
```
[WARNING] AIè¿æ¥æ£€æµ‹ï¼šäº‘ç«¯APIä¸å¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰
[WARNING]   é”™è¯¯: æœªé…ç½®API Key
```

### æœ¬åœ°Ollamaæ¨¡å¼ï¼ˆå¯ç”¨ï¼‰
```
[INFO] AIè¿æ¥æ£€æµ‹ï¼šOllamaå¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰ - qwen2.5:7b
```

### æœ¬åœ°Ollamaæ¨¡å¼ï¼ˆä¸å¯ç”¨ï¼‰
```
[WARNING] AIè¿æ¥æ£€æµ‹ï¼šOllamaä¸å¯ç”¨ï¼ˆå½“å‰æ¨¡å¼ï¼‰
[WARNING]   é”™è¯¯: è¿æ¥è¢«æ‹’ç»

OllamaæœåŠ¡æœªè¿è¡Œ
è¯·åœ¨ç»ˆç«¯æ‰§è¡Œï¼šollama serve
```

## ä¿®æ”¹æ–‡ä»¶

### src/ui/MainWindow.cpp
- ä¿®æ”¹`showAIConnectionStatus()`æ–¹æ³•
- æ·»åŠ ç”¨æˆ·æ¨¡å¼é€‰æ‹©çš„åˆ¤æ–­
- æ ¹æ®ç”¨æˆ·é€‰æ‹©æ˜¾ç¤ºå¯¹åº”çš„çŠ¶æ€
- æ·»åŠ "ï¼ˆå½“å‰æ¨¡å¼ï¼‰"æ ‡è¯†åˆ°æ—¥å¿—

## ç¼–è¯‘ç»“æœ

```
âœ… ç¼–è¯‘æˆåŠŸ
âœ… å¯æ‰§è¡Œæ–‡ä»¶: build\CodePracticeSystem.exe
âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
```

## ç”¨æˆ·ä½“éªŒæ”¹è¿›

### æ”¹è¿›å‰ âŒ
- åˆ‡æ¢åˆ°äº‘ç«¯API â†’ æ˜¾ç¤º"Ollamaå·²è¿æ¥"ï¼ˆå›°æƒ‘ï¼‰
- åˆ‡æ¢åˆ°æœ¬åœ°Ollama â†’ å¯èƒ½æ˜¾ç¤º"äº‘ç«¯APIå·²è¿æ¥"ï¼ˆå›°æƒ‘ï¼‰
- ä¸çŸ¥é“å½“å‰å®é™…ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆ
- æ˜¾ç¤ºä¸å®é™…ä½¿ç”¨ä¸ç¬¦

### æ”¹è¿›å âœ…
- åˆ‡æ¢åˆ°äº‘ç«¯API â†’ æ˜¾ç¤º"äº‘ç«¯APIå·²è¿æ¥"ï¼ˆæ¸…æ™°ï¼‰
- åˆ‡æ¢åˆ°æœ¬åœ°Ollama â†’ æ˜¾ç¤º"Ollamaå·²è¿æ¥"ï¼ˆæ¸…æ™°ï¼‰
- æ¸…æ¥šçŸ¥é“å½“å‰ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆ
- æ˜¾ç¤ºä¸å®é™…ä½¿ç”¨ä¸€è‡´
- æ—¥å¿—æ˜ç¡®æ ‡æ³¨"ï¼ˆå½“å‰æ¨¡å¼ï¼‰"

## æ€»ç»“

é€šè¿‡æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„æ¨¡å¼æ¥æ˜¾ç¤ºAIè¿æ¥çŠ¶æ€ï¼Œç°åœ¨ï¼š

- âœ… æ˜¾ç¤ºä¸ç”¨æˆ·é€‰æ‹©ä¸€è‡´
- âœ… åˆ‡æ¢æ¨¡å¼åçŠ¶æ€æ­£ç¡®æ›´æ–°
- âœ… æ¸…æ™°çš„æ—¥å¿—æ ‡è¯†å½“å‰æ¨¡å¼
- âœ… ç”¨æˆ·ä¸å†å›°æƒ‘
- âœ… åªæ£€æŸ¥å’Œæ˜¾ç¤ºå½“å‰æ¨¡å¼çš„çŠ¶æ€

**ç°åœ¨åˆ‡æ¢åˆ°æœ¬åœ°AIåï¼Œæ£€æµ‹é€»è¾‘ä¼šæ­£ç¡®æ˜¾ç¤ºæœ¬åœ°AIçš„çŠ¶æ€äº†ï¼** ğŸ‰
