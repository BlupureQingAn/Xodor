# å†å²è®°å½•åŠŸèƒ½ä¿®å¤å’Œç»Ÿä¸€

## é—®é¢˜æè¿°
1. å†å²èœå•çš„åšé¢˜è®°å½•åŠ è½½æœ‰é—®é¢˜
2. `HistoryWidget`ä½¿ç”¨é”™è¯¯çš„æ•°æ®æºï¼ˆè¯»å–user_answersç›®å½•çš„JSONæ–‡ä»¶ï¼‰
3. ä»£ç å·²æ”¹ä¸ºä¿å­˜.cppæ–‡ä»¶ï¼Œä½†å†å²è®°å½•è¿˜åœ¨è¯»å–.jsonæ–‡ä»¶
4. æ²¡æœ‰ä½¿ç”¨`ProgressManager`ä½œä¸ºç»Ÿä¸€çš„æ•°æ®æº

## è§£å†³æ–¹æ¡ˆ

### 1. ç»Ÿä¸€æ•°æ®æº
**æ ¸å¿ƒåŸåˆ™**ï¼šæ‰€æœ‰è¿›åº¦å’Œå†å²æ•°æ®éƒ½é€šè¿‡`ProgressManager`ç®¡ç†

**æ•°æ®æµ**ï¼š
```
ç”¨æˆ·æ“ä½œ â†’ ProgressManager â†’ progress.json
                â†“
         HistoryWidgetè¯»å–
         QuestionBankPanelè¯»å–
         PracticeStatsPanelè¯»å–
```

### 2. é‡å†™HistoryWidget
**ä½ç½®**ï¼š`src/ui/HistoryWidget.cpp`

**ä¿®æ”¹å‰çš„é—®é¢˜**ï¼š
```cpp
// é”™è¯¯ï¼šè¯»å–user_answersç›®å½•çš„JSONæ–‡ä»¶
QDir dir("data/user_answers");
QStringList filters;
filters << "*.json";  // ä½†ç°åœ¨ä»£ç ä¿å­˜ä¸º.cppæ–‡ä»¶
QFileInfoList files = dir.entryInfoList(filters, QDir::Files);
```

**ä¿®æ”¹åçš„å®ç°**ï¼š
```cpp
// æ­£ç¡®ï¼šä½¿ç”¨ProgressManagerä½œä¸ºæ•°æ®æº
ProgressManager &pm = ProgressManager::instance();
QuestionBankManager &qbm = QuestionBankManager::instance();

// è·å–æ‰€æœ‰æœ‰è¿›åº¦è®°å½•çš„é¢˜ç›®
QStringList allStatuses;
allStatuses << pm.getQuestionsByStatus(QuestionStatus::NotStarted)
            << pm.getQuestionsByStatus(QuestionStatus::InProgress)
            << pm.getQuestionsByStatus(QuestionStatus::Completed)
            << pm.getQuestionsByStatus(QuestionStatus::Mastered);
```

### 3. æ–°å¢åŠŸèƒ½

#### ç»Ÿè®¡ä¿¡æ¯æ 
æ˜¾ç¤ºå…¨å±€ç»Ÿè®¡ï¼š
- æ€»é¢˜æ•°
- å·²å®Œæˆæ•°
- æ€»æ­£ç¡®ç‡

#### è¯¦ç»†å†å²è®°å½•è¡¨æ ¼
6åˆ—ä¿¡æ¯ï¼š
1. **é¢˜ç›®ID** - å”¯ä¸€æ ‡è¯†
2. **é¢˜ç›®æ ‡é¢˜** - ä»QuestionBankManagerè·å–
3. **çŠ¶æ€** - æœªå¼€å§‹/è¿›è¡Œä¸­/å·²å®Œæˆ/å·²æŒæ¡ï¼ˆå¸¦é¢œè‰²ï¼‰
4. **å°è¯•æ¬¡æ•°** - æ€»å…±æäº¤æ¬¡æ•°
5. **æ­£ç¡®ç‡** - æ­£ç¡®æ¬¡æ•°/æ€»æ¬¡æ•°
6. **æœ€åæäº¤æ—¶é—´** - æœ€è¿‘ä¸€æ¬¡æäº¤çš„æ—¶é—´

#### æ’åº
æŒ‰æœ€åæäº¤æ—¶é—´å€’åºæ’åˆ—ï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰

#### è‡ªåŠ¨åŠ è½½
æ„é€ å‡½æ•°ä¸­è‡ªåŠ¨è°ƒç”¨`loadHistory()`ï¼Œæ— éœ€æ‰‹åŠ¨è§¦å‘

### 4. UIä¼˜åŒ–

#### æ ‡é¢˜æ 
- ğŸ“Š å›¾æ ‡ + "åšé¢˜å†å²è®°å½•"æ ‡é¢˜
- ğŸ”„ åˆ·æ–°æŒ‰é’®

#### è¡¨æ ¼æ ·å¼
- æ·±è‰²ä¸»é¢˜ï¼ˆ#1e1e1eèƒŒæ™¯ï¼‰
- äº¤æ›¿è¡Œé¢œè‰²
- é€‰ä¸­è¡Œçº¢è‰²é«˜äº®ï¼ˆ#660000ï¼‰
- å›ºå®šåˆ—å®½ï¼Œæœ€åä¸€åˆ—è‡ªåŠ¨æ‹‰ä¼¸

#### çŠ¶æ€é¢œè‰²
- æœªå¼€å§‹ï¼šç°è‰² (#888)
- è¿›è¡Œä¸­ï¼šæ©™è‰² (#ffa500)
- å·²å®Œæˆï¼šç»¿è‰² (#00ff00)
- å·²æŒæ¡ï¼šé‡‘è‰² (#ffd700)

### 5. æ•°æ®ä¸€è‡´æ€§

**ç»Ÿä¸€çš„æ•°æ®æº**ï¼š
- `ProgressManager` - å”¯ä¸€çš„è¿›åº¦æ•°æ®ç®¡ç†å™¨
- æ‰€æœ‰ç»„ä»¶éƒ½ä»è¿™é‡Œè¯»å–æ•°æ®
- ä¿è¯æ•°æ®ä¸€è‡´æ€§

**æ•°æ®æ–‡ä»¶**ï¼š
- `data/progress.json` - è¿›åº¦æ•°æ®ï¼ˆProgressManagerç®¡ç†ï¼‰
- `data/user_answers/*.cpp` - ä»£ç æ–‡ä»¶ï¼ˆAutoSaverç®¡ç†ï¼‰
- `data/conversations/*.json` - AIå¯¹è¯è®°å½•ï¼ˆAIAssistantPanelç®¡ç†ï¼‰

**æ•°æ®å…³ç³»**ï¼š
```
progress.json (ä¸»æ•°æ®)
â”œâ”€â”€ questionId
â”œâ”€â”€ status (çŠ¶æ€)
â”œâ”€â”€ attemptCount (å°è¯•æ¬¡æ•°)
â”œâ”€â”€ correctCount (æ­£ç¡®æ¬¡æ•°)
â”œâ”€â”€ lastAttemptTime (æœ€åæäº¤æ—¶é—´)
â””â”€â”€ lastCode (æœ€åä»£ç  - å¯é€‰)

user_answers/*.cpp (ä»£ç å¤‡ä»½)
â””â”€â”€ {questionId}.cpp

conversations/*.json (AIå¯¹è¯)
â””â”€â”€ {questionId}.json
```

## ä¼˜åŠ¿

### æ•°æ®ä¸€è‡´æ€§
1. **å•ä¸€æ•°æ®æº**ï¼šé¿å…æ•°æ®ä¸åŒæ­¥
2. **å®æ—¶æ›´æ–°**ï¼šProgressManagerå‘å‡ºä¿¡å·ï¼Œæ‰€æœ‰ç»„ä»¶è‡ªåŠ¨æ›´æ–°
3. **å¯é æ€§**ï¼šä¸ä¾èµ–æ–‡ä»¶ç³»ç»Ÿæ‰«æ

### ç”¨æˆ·ä½“éªŒ
1. **å®Œæ•´ä¿¡æ¯**ï¼šæ˜¾ç¤ºé¢˜ç›®æ ‡é¢˜ã€çŠ¶æ€ã€æ­£ç¡®ç‡ç­‰
2. **ç›´è§‚å±•ç¤º**ï¼šé¢œè‰²åŒºåˆ†çŠ¶æ€ï¼Œä¸€ç›®äº†ç„¶
3. **è‡ªåŠ¨åŠ è½½**ï¼šæ‰“å¼€å³å¯æŸ¥çœ‹ï¼Œæ— éœ€æ‰‹åŠ¨åˆ·æ–°

### å¯ç»´æŠ¤æ€§
1. **ç»Ÿä¸€æ¥å£**ï¼šæ‰€æœ‰ç»„ä»¶ä½¿ç”¨ç›¸åŒçš„API
2. **æ˜“äºæ‰©å±•**ï¼šæ–°å¢åŠŸèƒ½åªéœ€ä¿®æ”¹ProgressManager
3. **ä»£ç æ¸…æ™°**ï¼šèŒè´£æ˜ç¡®ï¼Œé€»è¾‘ç®€å•

## æµ‹è¯•å»ºè®®

### æµ‹è¯•åœºæ™¯
1. **ç©ºå†å²**ï¼šé¦–æ¬¡ä½¿ç”¨ï¼Œåº”æ˜¾ç¤º"æš‚æ— åšé¢˜å†å²è®°å½•"
2. **æœ‰å†å²**ï¼šåšè¿‡é¢˜ç›®åï¼Œåº”æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯
3. **åˆ·æ–°**ï¼šç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼Œåº”é‡æ–°åŠ è½½æœ€æ–°æ•°æ®
4. **æ’åº**ï¼šæœ€æ–°æäº¤çš„é¢˜ç›®åº”åœ¨æœ€å‰é¢

### éªŒè¯ç‚¹
- âœ… é¢˜ç›®æ ‡é¢˜æ­£ç¡®æ˜¾ç¤º
- âœ… çŠ¶æ€é¢œè‰²æ­£ç¡®
- âœ… å°è¯•æ¬¡æ•°å’Œæ­£ç¡®ç‡å‡†ç¡®
- âœ… æ—¶é—´æ ¼å¼æ­£ç¡®
- âœ… ç»Ÿè®¡ä¿¡æ¯å‡†ç¡®

## ä¿®æ”¹æ–‡ä»¶
- `src/ui/HistoryWidget.h` - æ›´æ–°æ¥å£å®šä¹‰
- `src/ui/HistoryWidget.cpp` - é‡å†™å®ç°ï¼Œä½¿ç”¨ProgressManager

## å®Œæˆæ—¶é—´
2024-12-06
