

# 第39次CCF计算机软件能力认证

## 题目 1：蒙特卡洛 (Monte Carlo)

**时间限制：** 1.0 秒
**空间限制：** 512 MiB

### 题目描述

小 P 在学习了蒙特卡洛模拟后，设计了如下实验来估算 $\pi$ 的值。

**准备阶段：** 对于给定参数 $a$，小 P 在平面直角坐标系上首先画出一个边长为 $2a$ 的正方形，左下角和右上角坐标分别为 $(-a,-a)$ 和 $(a,a)$；然后再画一个以坐标原点 $(0,0)$ 为圆心、半径为 $a$ 的圆。

**随机采样：** 小 P 在正方形内（含边界）随机生成 $n$ 个坐标点，并统计其中有多少个点位于圆形内（含边界）。

**结果分析：** 随机生成的坐标点落在圆形内的概率等于圆形的面积除以正方形的面积，所以理论上有：
$$ \frac{m}{n} \approx \frac{\pi a^2}{4a^2} $$
这里我们用 $m$ 表示落在圆内的坐标个数，进而可以使用如下公式来估算 $\pi$ 的值：
$$ \pi \approx \frac{4m}{n} $$

小 P 已经生成好了 $n$ 个随机坐标点，但不清楚该如何统计落在圆内的数量，试编程帮助小 P 完成实验。

### 输入格式

从标准输入读入数据。
输入的第一行包含空格分隔的两个正整数 $n$ 和 $a$，分别表示坐标数量和边长参数。
接下来 $n$ 行，每行包含空格分隔的两个数，表示一个坐标。

### 输出格式

输出到标准输出。
输出一个实数，表示按上述方法估算的 $\pi$ 的值。

### 样例 1

**输入：**

```text
4 5
3 4
-5 5
0 0
3 4
```

**输出：**

```text
3.0
```

**解释：**
只有坐标点 $(-5, 5)$ 位于圆外。

### 样例 2

**输入：**

```text
5 5
3.01 3.99
-5 5
0 0
2.9 4.1
-3 -4
```

**输出：**

```text
2.4
```

**解释：**
有三个坐标点位于圆内（含边界）。

### 子任务

* 50% 的测试点满足：所有输入的坐标均为整数；
* 全部的测试点满足：$0 < n, a \le 1000$，所有坐标点均在正方形内（含边界）且输入的实数坐标最多包含两位小数。

### 评分方式

输出结果与标准答案相比绝对误差小于 $0.0001$ 即可，推荐保留六位小数输出结果。

---

## 题目 2：水印检查 (Watermark Check)

**时间限制：** 1.0 秒
**空间限制：** 512 MiB

### 题目背景

一幅长宽分别为 $n$ 个像素和 $m$ 个像素的灰度图像可以表示为一个 $n \times m$ 大小的矩阵 $A$。其中每个元素 $A_{i,j}$ ($1 \le i \le n, 1 \le j \le m$) 是一个 $[0, L-1]$ 范围内的整数，表示对应位置像素的灰度值。具体来说，一个 8 比特的灰度图像中每个像素的灰度范围是 $[0, 255]$。

### 题目描述

小 P 在学习了数字图像处理后，设计了一种形如 CSP 的水印。具体来说，若想检测出水印，需选定一个阈值参数 $k$，然后将图像二值化：

* 灰度值大于等于 $k$ 的像素变为白色；
* 灰度值小于 $k$ 的像素变为黑色。

然后检查图像中是否有 $5 \times 9$ 的区域如下所示（为方便展示用绿色替代白色，本题中即为 * 表示白色，- 表示黑色）：

```text
* * * * * * * * *
* - - * - - * - *
* - - * * * * * -
* - - - - * * - -
* * * * * * * - -
```

即呈现出 CSP 三个字母的形状。

该水印较为简单，无需考虑旋转、翻转等复杂情况；只需检查灰度图像 $A$ 是否包含一个大小为 $5 \times 9$ 的子矩阵 $A_{i,j} \dots A_{i+4, j+8}$，其中大于等于阈值 $k$ 和小于的像素分布与上图完全一致。

对于给定的 $n \times n$ 大小的灰度图像 $A$，试计算出所有能检查出水印 CSP 的阈值 $k$。

### 输入格式

从标准输入读入数据。
输入的第一行包含由空格分隔的两个正整数 $n$ 和 $L$，表示图像的大小和像素灰度值的范围。
接下来 $n$ 行输入矩阵 $A$，其中第 $i$ 行 ($1 \le i \le n$) 包含用空格分隔的 $n$ 个整数，依次为 $A_{i,1}, A_{i,2}, \dots, A_{i,n}$。

### 输出格式

输出到标准输出。
输出若干行，每行包含一个整数，表示一个可以检查出水印 CSP 的阈值 $k$。
$[0, L-1]$ 范围内所有可行阈值 $k$ 按从小到大顺序输出。

### 样例

**输入：**

```text
9 256
9 9 8 8 9 9 9 8 255
9 0 0 8 0 0 7 0 8
9 0 0 8 7 9 7 7 5
9 0 0 0 0 8 7 0 0
7 7 8 7 7 8 8 6 5
6 2 2 5 1 1 5 1 6
6 2 2 6 6 6 7 5 3
6 2 2 2 1 5 8 1 1
7 7 8 7 7 8 8 2 3
```

**输出：**

```text
4
5
7
```

### 子任务

* 80% 的测试点满足：$n \le 50, L=256$；
* 全部的测试点满足：$9 \le n \le 200, L \in \{256, 65536\}$，像素值均在 $[0, L-1]$ 范围内，且保证至少存在一个阈值可以检测出水印 CSP。

---

## 题目 3：HTTP 头信息

**时间限制：** 1.0 秒
**空间限制：** 512 MiB

### 题目背景

西西艾弗岛大数据公司的服务器每天要处理海量的 HTTP 请求。为了提高传输效率，公司决定将所有服务器的 HTTP/1.1 版本升级到 HTTP/2 版本。小 C 负责实现 HTTP 头信息的压缩算法 HPACK。

HTTP/2 版本中，头信息使用 HPACK（二进制格式）传输。HPACK 引入了两张表格：**静态表格**和**动态表格**。

* 静态表格是预定义的，包含常用键值对。
* 动态表格根据实际请求动态更新。在解码开始前为空。添加新条目时插入到最前面（编号 $S+1$），旧条目后移。当动态表格条目数超过限制时，删除最旧的条目。

表格条目从 1 开始编号。静态表格有 $S$ 条，编号 $1 \dots S$；动态表格有 $D$ 条，编号 $S+1 \dots S+D$。

### 题目描述

HPACK 编码后的头信息由一系列指令组成，指令分为：

1. **表格引用指令**：`1 i`。直接输出编号为 $i$ 的条目的字段名和字段值。
2. **字面量并索引指令**：`2 0 k v` 或 `2 i v`。若编号为 0，则 $k$ 为字段名；否则使用编号 $i$ 条目的字段名。$v$ 为字段值。输出后将该键值对插入动态表格。
3. **字面量不索引指令**：`3 0 k v` 或 `3 i v`。类似指令 2，但**不会**将键值对插入动态表格。

字符串可以是普通字符串，也可以是 **Huffman 编码**的字符串。

* **Huffman 树表示**：若节点是叶子，输出 1 和对应字符；否则输出 0，递归左子树和右子树。
  * 例如：`001b01c1d1a` 表示的树中，a=1, b=00, c=010, d=011。
* **普通字符串**：格式 `s`。若 `s` 开头不是 `H`，原样输出；若开头是 `HH`，去掉了第一个 `H` 后输出。
* **Huffman 编码字符串**：格式 `Hb`。$b$ 是十六进制串。解码规则：高位存高位，最后字节低位补 0。末尾增加一字节表示补 0 的个数 $p$。

### 输入格式

输入第一行包含两个整数 $S$ 和 $D$，表示静态表格和动态表格的条目数。
接下来 $S$ 行，每行包含空格分隔的两个字符串，表示静态表格的键值对。
接下来一行包含一个字符串，表示 Huffman 树的结构。
接下来一行包含一个整数 $N$，表示指令条数。
接下来 $N$ 行，每行表示一条指令。

### 输出格式

输出 $N$ 行，格式为 `key: value`。对于普通字符串和 Huffman 编码字符串，需输出解码后的原始字符串。

### 样例 1

**输入：**

```text
3 3
Foo Bar
Foo Barz
bar barzz1
001b01c1d1a
11
1 1
3 3 ABCD
3 0 H898007 HHIJK
2 0 H898007 EFGH
1 4
2 0 DDDD EEEE
2 5 GGGG
1 4
1 6
2 0 HHHH IIII
1 4
```

**输出：**

```text
Foo: Bar
bar: ABCD
abcd: HIJK
abcd: EFGH
abcd: EFGH
DDDD: EEEE
abcd: GGGG
abcd: GGGG
abcd: EFGH
HHH: IIII
HHH: IIII
```

### 子任务

* 20%：仅包含表格引用指令。
* 40%：仅包含表格引用和字面量不索引，无 Huffman 编码。
* 60%：含有所有类型，且字面量并索引指令数目不超过 $D$。
* 100%：$1 \le S \le 64, 1 \le D \le 120, 1 \le N \le 1000$。Huffman 编码长度不超过 8 位。解码前后字符串长度 $\le 150$。

---

## 题目 4：造题计划（上）

**时间限制：** 1.0 秒
**空间限制：** 512 MiB

### 题目背景

西西艾弗大学的第三十九届算法考试就要开始了，小 C 正在紧张地造题……

### 题目描述

给定一棵 $n$ 个结点的树，要求选手给每个结点分配一个权值，使得树上所有点的权值构成一个 $0$ 到 $n-1$ 的排列，并满足 $m$ 条限制。

你需要帮小 C 写 SPJ 的核心部分：接收一棵 $n$ 个结点的树，其中编号为 $i$ 的点有权值 $a_i$（保证构成排列）。接下来依次检验 $m$ 条限制，每条限制给定树上的两个结点 $x$ 和 $y$，你需要求出从 $x$ 到 $y$ 的简单路径上所有点的权值构成集合的 **mex** 值。

**MEX 定义**：$mex(S)$ 表示最小的没有在 $S$ 中出现过的自然数。
例如：$mex(\{0, 1, 2, 5\}) = 3$, $mex(\{1, 2\}) = 0$。

### 输入格式

第一行包含两个正整数 $n, m$。
第二行包含 $n$ 个正整数 $a_1, a_2, \dots, a_n$，表示每个结点的权值。
接下来 $n-1$ 行每行两个整数，表示树上的一条边。
接下来 $m$ 行每行两个整数 $x_i, y_i$，表示一条限制（查询）。

### 输出格式

输出 $m$ 行，每行一个正整数，表示对应路径权值集合的 mex 值。

### 样例 1

**输入：**

```text
7 3
1 0 2 6 3 4 5
1 2
2 5
2 6
1 3
3 7
1 4
5 3
6 3
7 4
```

**输出：**

```text
4
3
0
```

### 子任务

* 20%：$n, m \le 1000$。
* 20%：保证给定的树是一条链。
* 30%：$n, m \le 5 \times 10^4$。
* 30%：无特殊限制。
* 对于所有数据：$1 \le n, m \le 2 \times 10^5$。

---

## 题目 5：造题计划（下）

**时间限制：** 5.0 秒
**空间限制：** 512 MiB

### 题目背景

小 C 和 小 F 需要在 $n$ 天时间内造出若干道题目。

### 题目描述

分工如下：

* 小 C 负责造题，小 F 负责验题。
* 题目必须先由小 C 造完，才能由小 F 验。
* 每天小 C 在上午造题，小 F 在下午验题。
* 小 C 一天最多出一个题，小 F 一天最多验一个题。
* 在第 $i$ 天，小 C 造一个题需要的精力值为 $a_i$，小 F 验一个题需要的精力值为 $b_i$。

总精力值不可以大于 $m$。
求在这 $n$ 天里他们最多能造出多少题目（即完成“造题+验题”全过程的题目数量）。

### 输入格式

第一行包含两个正整数 $n, m$，表示天数和最大总精力值。
第二行包含 $n$ 个正整数 $a_1, \dots, a_n$，表示每天小 C 造题花费。
第三行包含 $n$ 个正整数 $b_1, \dots, b_n$，表示每天小 F 验题花费。

### 输出格式

输出一行一个正整数，表示最多能造出的题目数量。

### 样例 1

**输入：**

```text
5 12
3 5 7 2 9
4 2 8 3 7
```

**输出：**

```text
2
```

**解释：**
小 C 在第 1 天 ($a_1=3$) 和第 4 天 ($a_4=2$) 造题。
小 F 在第 2 天 ($b_2=2$) 和第 4 天 ($b_4=3$) 验题。
总花费 $3+2+2+3 = 10 \le 12$。
注意：小 F 可以在第 4 天下午验小 C 第 4 天上午造的题。

### 子任务

* 20%：$n \le 100$。
* 30%：$n \le 3000$。
* 20%：$n \le 10^5$。
* 30%：无特殊限制。
* 对于所有数据：$1 \le n \le 5 \times 10^5, 1 \le a_i, b_i \le 10^9, 1 \le m \le 10^{18}$。
