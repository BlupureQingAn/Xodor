# 错误行号调试指南

## 问题现象
编译错误的行号有时准确，有时偏移5-7行甚至更多。

## 可能的原因

### 1. 代码模板注释导致偏移
**已修复**：移除了基础模板第一行的注释。

### 2. 默认代码模板的注释行
`generateDefaultCode`函数生成的代码包含多行注释：
```cpp
#include <iostream>
using namespace std;

int main() {
    // TODO: 读取输入         ← 第5行
    // 提示：根据题目要求...   ← 第6行
    
    // TODO: 处理逻辑         ← 第8行
    // 提示：在这里实现...     ← 第9行
    
    // TODO: 输出结果         ← 第11行
    // 提示：按照题目要求...   ← 第12行
    
    return 0;
}
```

如果用户删除了这些注释行，编辑器显示的行号会减少，但语法检查器检查的是实际代码，行号就会不匹配。

### 3. 调试方法

已添加调试输出到`SyntaxChecker::performCheck()`：
```cpp
qDebug() << "[SyntaxChecker] Code line count:" << m_pendingCode.count('\n') + 1;

// 输出前10行代码
QStringList codeLines = m_pendingCode.split('\n');
qDebug() << "[SyntaxChecker] First 10 lines of code:";
for (int i = 0; i < qMin(10, codeLines.size()); ++i) {
    qDebug() << QString("  Line %1: %2").arg(i + 1).arg(codeLines[i]);
}
```

## 测试步骤

1. 运行程序
2. 选择一道题目
3. 在代码中故意制造错误（如缺少分号）
4. 查看控制台输出的调试信息
5. 对比：
   - 编辑器显示的行号
   - 错误列表显示的行号
   - 调试输出的代码内容

## 预期发现

通过调试输出，我们应该能看到：
- 语法检查器实际检查的代码内容
- 代码的总行数
- 前10行的具体内容

这将帮助我们确定：
- 用户看到的代码和实际检查的代码是否一致
- 是否有隐藏的行或额外的代码被添加

## 下一步

根据调试输出的结果，可能需要：

1. **如果代码一致**：问题可能在错误解析的正则表达式
2. **如果代码不一致**：需要找到代码被修改的地方
3. **如果有额外的行**：需要调整行号计算逻辑

## 临时解决方案

如果问题复杂，可以考虑：
1. 简化默认代码模板，减少注释行
2. 在错误信息中同时显示代码片段，让用户更容易定位
3. 添加"跳转到错误"功能，直接定位到错误位置

## 运行测试

请运行程序并：
1. 打开一道题目
2. 写一些有错误的代码
3. 查看控制台输出
4. 将调试信息反馈给我

这样我们就能准确定位问题所在。
