三、用户全流程实现细节（操作 + 系统响应 + 数据流转）
第一阶段：初始化与本地题库导入（奠定刷题基础）
1. 用户操作：启动软件 + 导入本地题库
双击打开软件，进入「题库管理」页面；
点击「导入本地题库」按钮，在弹窗中选择本地分类文件夹（如ccf），点击「确认导入」。
2. 系统后台处理流程（自动执行，无需用户干预）
（1）文件拷贝与存储
自动将用户选择的分类文件夹（含所有.md 题库文件）完整拷贝至项目根目录「原始题库」文件夹，形成原始文件备份：
「原始题库」为只读目录，禁止用户修改，确保原始数据安全。
（2）题目结构解析与规则生成
从「原始题库 /ccf」中抽取 3 份文件（不足 3 份全选），自动识别 CCF 题目各模块格式特征：
题干：匹配「【题目描述】」「问题：」等前缀；
输入 / 输出格式：匹配「【输入】」「输入格式：」「【输出】」「输出格式：」等标识；
多组测试数据：按空行、「测试用例 X：」等分隔符拆分，按顺序编号（输入 1→输出 1、输入 2→输出 2）；
代码限制：提取「【时间限制】」「【内存限制】」「支持语言：」等内容；
题目拆分：按「第 X 题」「题目 X」等标识拆分单文件内多道题目。
生成「ccf 分类专属解析规则」，保存至软件后台config/ccf_parse_rule.json，覆盖模块提取、数据绑定、异常处理逻辑。
（3）批量解析 + 强制测试数据扩充
按「原始题库 /ccf」内文件名称排序，依次处理每个.md 文件：
结构化提取：拆分每道题目，提取题干、原始测试数据（输入 + 对应输出）、代码限制、辅助信息；
AI 测试数据扩充：调用本地 AI 模型 / API，基于原始数据特征生成 3-5 组补充数据（覆盖边界 / 异常 / 等价类场景），标注「AI 补充」，与原始数据合并排序（如输入 1-7 组）；
结构化存储：每道题按「题干→测试数据与输出（原始 + AI 补充）→代码限制→辅助信息」格式，保存为第1题.md「第 2 题.md，统一放入与原文件同名的文件夹（如考试一 `）。
（4）基础题库生成 + 出题规则固化
所有考试文件夹（如考试一「考试二 `）归类至「基础题库 /ccf」，形成标准化结构：
自动分析「基础题库 /ccf」所有题目，填充出题模式规律.md（含套题数量、难度 / 知识点占比、题号专属规则、代码限制通用规则）。
3. 系统反馈
弹窗提示：“【ccf】题库导入成功！已生成基础题库（含 AI 扩充测试数据），可直接刷题或生成模拟题”；
「题库管理」页面刷新，新增「本地题库 - ccf」选项卡，显示题库内考试文件夹及题目数量。
第二阶段：刷本地题库（AI 辅助 + 代码自动保存 + 测试验证）
1. 用户操作：选择题目 + 进入刷题页面
在「题库管理→本地题库 - ccf」中，点击目标考试文件夹（如考试一），选择具体题目（如「第一题」），进入「刷题页面」。
2. 刷题页面核心组件与功能
组件	功能说明
题目详情区	展示结构化题目信息（题干、测试数据与输出、代码限制），支持折叠 / 展开测试数据
AI 辅助区	提供实时提示、知识点讲解、问题答疑功能（用户可输入提问，AI 即时回复）
代码编辑区	支持 C++/Python/Java 三种语言，语法高亮、自动缩进，默认显示空模板代码
测试按钮	点击后运行所有测试样例，显示测试结果
提交按钮	确认答题完成，记录答题结果（无需额外操作，测试通过即视为提交成功）
3. 核心功能实现
（1）AI 实时提示与讲解
用户可在 AI 辅助区输入问题（如 “这道题用什么算法？”“边界条件怎么处理？”），系统调用本地 AI/API 实时生成回复；
支持「一键获取思路提示」快捷功能，AI 基于题目考点输出不涉及具体代码的解题思路。
（2）代码自动保存（核心保障）
自动保存触发时机：
代码编辑区输入停止 3 秒后；
用户切换页面、最小化软件、关闭刷题页面时；
点击「测试」「提交」按钮前；
保存路径：项目根目录/用户数据/代码备份/本地题库/ccf/考试一/第一题_用户名_时间戳.json；
支持「代码回溯」：刷题页面提供「历史版本」下拉框，可选择恢复之前保存的代码版本。
（3）代码运行与测试验证
用户操作：编写代码后，点击「测试」按钮；
系统处理：
读取当前题目.md 文件中的所有测试样例（原始 + AI 补充）；
调用内置代码运行环境，编译 / 解释用户代码；
依次输入每组测试数据，捕获代码输出；
比对代码输出与标准输出，记录通过 / 失败状态；
测试结果展示：
总览：“共 7 组测试样例，通过 5 组，失败 2 组”；
详情：列出每组测试样例的输入、预期输出、实际输出、失败原因（如 “答案错误”“运行超时”“内存超限”）；
优化建议：AI 基于失败样例，给出代码修改提示（如 “边界值处理缺失，建议补充 X 条件”）。
4. 答题完成与数据记录
用户点击「提交」按钮，系统记录答题结果（测试通过率、答题时长、代码最终版本）；
「题库管理」页面标记该题目状态（未做 / 已做 / 已通过）；
数据存储路径：项目根目录/用户数据/答题记录/本地题库_答题记录.json。
第三阶段：生成模拟题库（一键触发 + 标准化套题）
1. 用户操作：发起模拟题库生成
在「题库管理」页面点击「生成模拟题库」按钮，选择目标分类（如ccf），输入生成套题数量（如 2 套），点击「确认生成」。
2. 系统后台处理流程
（1）规则读取与套题生成
读取「基础题库 /ccf/ 出题模式规律.md」，获取套题规则（题目数量、难度 / 知识点占比、题号专属规则等）；
调用 AI 模型，按规则生成模拟题：
题干：贴合 CCF 风格，包含完整输入 / 输出格式说明；
测试数据：生成 5-8 组样例（覆盖基础 / 边界 / 异常 / 等价类场景），输入与输出一一对应；
代码限制：遵循分类通用规则（如时间限制 1 秒、内存限制 256MB）；
每道题保存为第一题.md「第二题.md`，每套题独立放入「模拟题 1」「模拟题 2」文件夹，文件夹内新增「答题说明.md」（套题规则 + 测试工具使用方法）。
（2）模拟题库存储
套题文件夹归类至「人工模拟题库 /ccf」，结构如下：
3. 系统反馈
弹窗提示：“【ccf】模拟题库生成成功！共生成 2 套模拟题，可在「模拟题库 - ccf」中刷题”；
「题库管理」页面新增「模拟题库 - ccf」选项卡，显示所有模拟套题及题目数量。
第四阶段：刷模拟题（流程与本地题库一致，新增套题计时）
1. 用户操作：选择模拟套题 + 开始刷题
在「题库管理→模拟题库 - ccf」中，点击目标套题（如「模拟题 1」），选择「开始刷题」（支持按题号顺序刷题，不可跳题）。
2. 核心差异功能：套题计时
点击「开始刷题」后，系统自动启动套题计时器（显示剩余时间 / 已用时间），计时规则参考 CCF 认证（如 4 道题共 180 分钟）；
计时器支持暂停（仅允许暂停 1 次，最长暂停 30 分钟），暂停时不保存代码以外的答题状态；
计时结束后，自动锁定代码编辑区，强制提交所有已答题目的代码，进行测试验证。
3. 其他功能
AI 辅助、代码自动保存、测试验证流程与「刷本地题库」完全一致；
答题完成后，系统生成「套题答题报告」，包含每题通过率、总得分、用时分布、知识点薄弱项分析。
第五阶段：关闭软件与数据恢复
1. 用户操作：关闭软件
点击软件窗口右上角「关闭」按钮，或通过任务栏关闭。
2. 系统自动处理
强制保存所有未提交的代码（按代码自动保存规则存储）；
记录当前刷题进度（如 “本地题库 - ccf - 考试一 - 第二题”“模拟题 1 - 第三题”）；
保存用户配置（如默认编程语言、AI 辅助功能开关状态）。
3. 下次启动恢复
软件重启后，自动加载上次未完成的刷题页面（代码编辑区恢复至最后保存版本）；
「题库管理」页面保留之前的答题状态标记（未做 / 已做 / 已通过）。
四、关键数据存储路径说明
目录 / 文件路径	用途	读写权限
项目根目录 / 原始题库	存储用户导入的原始题库文件	只读（系统）
项目根目录 / 基础题库	存储解析后 + AI 扩充数据的标准化题库	只读（系统）
项目根目录 / 人工模拟题库	存储生成的模拟套题	只读（系统）
项目根目录 / 用户数据 / 代码备份	自动保存用户编写的代码	读写（系统 + 用户）
项目根目录 / 用户数据 / 答题记录	记录用户答题结果、套题报告	读写（系统）
项目根目录 /config	存储解析规则、AI 配置等系统参数	只读（系统）
五、核心技术点实现说明
题目结构解析：基于正则表达式 + 关键词匹配，支持自定义格式特征（适配不同来源的 CCF 题库文件）；
AI 功能集成：提供本地模型（轻量化部署）与 API 调用两种模式，用户可在设置中切换，API Key 支持加密存储；
代码运行与测试：通过子进程调用系统编译器 / 解释器，捕获标准输出与错误信息，实现多组测试样例批量运行；
自动保存机制：采用异步存储方式，避免阻塞用户操作，同时生成时间戳版本，支持数据回溯；
套题计时：基于系统时间戳计算，防止用户修改系统时间作弊，暂停功能添加权限控制。