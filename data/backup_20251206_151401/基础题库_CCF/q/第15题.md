# 文件夹合并

## 题目描述

文件系统有 n 个文件夹（树形结构，根为1）。每个文件夹 i 存储 d_i 字节数据。操作：1) 合并文件夹 x 的所有直接子文件夹到 x（子文件夹的子文件夹变为 x 的子文件夹，数据合并），输出 x 的子文件夹数量和数据量；2) 访问文件夹 z，输出根到 z 的路径长度（节点数）。
输入格式：第一行 n, m。第二行 n-1 个整数 f_2,...,f_n 表示父文件夹。第三行 n 个整数 d_1,...,d_n。接下来 m 行，每行 op val（op=1 合并，op=2 访问）。
输出格式：对每个操作输出相应结果。

## 测试数据

### 测试用例 1 - 基本测试：样例输入 (原始数据)

**输入：**
```
4 6
1 1 3
100 0 200 300
2 1
2 4
1 1
2 4
1 1
1 1
```

**输出：**
```
1
3
1 300
2
0 600
0 600
```

### 测试用例 2 - 基本测试：链状结构，合并后路径变化 (原始数据)

**输入：**
```
3 4
1 2
10 20 30
2 1
2 3
1 1
2 3
```

**输出：**
```
1
3
0 60
2
```

### 测试用例 3 - 边界条件：只有两个文件夹（根和子） (原始数据)

**输入：**
```
2 3
1
5 10
2 1
2 2
1 1
```

**输出：**
```
1
2
0 15
```

### 测试用例 4 - 边界条件：单个文件夹（根） (AI补充)

**输入：**
```
1 2

50
2 1
1 1
```

**输出：**
```
1
0 50
```

### 测试用例 5 - 特殊情况：菊花图，合并根的所有子文件夹 (AI补充)

**输入：**
```
5 3
1 1 1 1
1 2 3 4 5
2 5
1 1
2 5
```

**输出：**
```
5
0 15
1
```

### 测试用例 6 - 特殊情况：只有访问操作，无合并 (AI补充)

**输入：**
```
4 2
1 2 3
0 0 0 0
2 4
2 2
```

**输出：**
```
4
2
```

## 题目信息

- **难度**: 中等
- **标签**: 树, 数据结构, 并查集, 模拟
