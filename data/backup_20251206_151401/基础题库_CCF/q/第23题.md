# 补丁应用 (Patch Application)

## 题目描述

实现一个 patch 程序，将补丁应用到原文件上。补丁由多个块组成，每个块以 @@ -NN,MM +nn,mm @@ 开头，随后是修改行（- 表示删除，+ 表示添加，空格表示上下文）。程序需要检查补丁合法性，并在原文件中寻找匹配位置（允许偏移 δ），然后应用修改。如果补丁损坏，输出 'Patch is damaged.'，否则输出应用后的文件内容。
输入格式：第一行为原文件行数 n，接下来 n 行为原文件内容，随后是补丁内容。

## 测试数据

### 测试用例 1 - 基本功能测试：样例输入输出 (原始数据)

**输入：**
```
7
bbb
a
1
2
3
4
5
dummy
@@ -1,4 +1,5 @@
-a
+b
 1
+c
 2
 3
@@ -6,2 +6,2 @@
-4
+6
 5
```

**输出：**
```
bbb
b
1
c
2
3
6
5
```

### 测试用例 2 - 边界条件：补丁只包含上下文，无实际修改 (原始数据)

**输入：**
```
3
line1
line2
line3
@@ -1,1 +1,1 @@
 line1
```

**输出：**
```
line1
line2
line3
```

### 测试用例 3 - 基本功能测试：删除一行 (原始数据)

**输入：**
```
2
A
B
@@ -1,2 +1,1 @@
-A
 B
```

**输出：**
```
B
```

### 测试用例 4 - 特殊情况：添加行到文件末尾 (AI补充)

**输入：**
```
1
X
@@ -1,0 +1,1 @@
+Y
```

**输出：**
```
X
Y
```

### 测试用例 5 - 特殊情况：在中间插入一行 (AI补充)

**输入：**
```
3
1
2
3
@@ -2,2 +2,3 @@
 2
+new
 3
```

**输出：**
```
1
2
new
3
```

### 测试用例 6 - 特殊情况：补丁损坏，上下文不匹配 (AI补充)

**输入：**
```
2
a
b
@@ -1,2 +1,1 @@
-a
-c
```

**输出：**
```
Patch is damaged.
```

### 测试用例 7 - 特殊情况：有偏移的匹配 (AI补充)

**输入：**
```
5
A
B
C
D
E
@@ -2,2 +2,2 @@
 B
+X
 C
```

**输出：**
```
A
B
X
C
D
E
```

## 题目信息

- **难度**: 困难
- **标签**: 字符串, 模拟, 文本处理
