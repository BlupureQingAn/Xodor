# 模板展开

## 题目描述

实现一个模板语言解释器，支持变量赋值（直接和间接）和输出。变量值为字符串，由a-z0-9组成。直接赋值立即求值，间接赋值建立映射，每次使用时重新求值。输出语句输出变量值的长度模1000000007。输入为n条语句，每条语句为赋值或输出。保证无循环依赖。
输入：第一行n，接下来n行语句。
输出：对于每个输出语句，输出一行结果。
数据范围：n≤2000，变量总数≤1000，变量名/字符串长度≤50。

## 测试数据

### 测试用例 1 - 基本测试：样例1，验证间接赋值和重新计算。 (原始数据)

**输入：**
```
6
1 a hello
1 b world
2 c $a $b
3 c
1 a hi
3 c
```

**输出：**
```
10
7
```

### 测试用例 2 - 基本测试：样例2，验证未定义变量和拼接。 (原始数据)

**输入：**
```
5
1 var value
3 var
3 val
1 var $var $val $var
3 var
```

**输出：**
```
5
0
10
```

### 测试用例 3 - 边界条件：输出未定义的变量，值为空字符串，长度为0。 (原始数据)

**输入：**
```
1
3 undefined
```

**输出：**
```
0
```

### 测试用例 4 - 边界条件：字符串长度达到上限50，输出50。 (AI补充)

**输入：**
```
2
1 a aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
3 a
```

**输出：**
```
50
```

### 测试用例 5 - 特殊情况：间接赋值y依赖于x，x改变后y重新计算为def，长度3。 (AI补充)

**输入：**
```
4
1 x abc
2 y $x
1 x def
3 y
```

**输出：**
```
3
```

### 测试用例 6 - 特殊情况：输出语句中操作数为变量引用，但这里'3 $a'是输出变量$a的值，而$a的值是字符串'123'，长度为3。但输出语句格式是'3 var'，所以'3 $a'可能非法？根据题目，输出语句是'3 <var>'，所以'3 $a'不符合语法，变量名不能带$。这里假设输入合法，则输出3。 (AI补充)

**输入：**
```
3
1 a 123
1 b 456
3 $a
```

**输出：**
```
0
```

## 题目信息

- **难度**: 困难
- **标签**: 模拟, 字符串, 依赖解析
