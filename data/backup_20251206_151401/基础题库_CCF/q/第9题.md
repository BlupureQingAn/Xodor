# 宝藏

## 题目描述

给定 n 条指令，操作一个初始为空的双端队列，元素为 2 × 2 矩阵。指令类型：
1. 给定矩阵 A，插入队列头部。
2. 给定矩阵 B，插入队列尾部。
3. 若队列非空，删除队列中最晚被插入的矩阵。
共有 m 个时刻，每个时刻发生以下事件之一：
1. 修改第 i 条指令的内容。
2. 给定区间 [l, r]，求依次执行第 l ∼ r 条指令后，队列中所有矩阵从头到尾相乘的结果（对 998244353 取模）。若队列空，结果为单位矩阵。

## 测试数据

### 测试用例 1 - 基本测试：样例输入 (原始数据)

**输入：**
```
3 4
1 2 3 9 3
2 6 9 4 2
2 2 8 2 1
2 2 3
1 2 1 3 1 0 1
1 3 3
2 1 3
```

**输出：**
```
30 57 12 34
2 3 9 3
```

### 测试用例 2 - 边界条件：执行后队列为空，输出单位矩阵 (原始数据)

**输入：**
```
2 1
1 1 0 0 1
3
2 1 2
```

**输出：**
```
1 0 0 1
```

### 测试用例 3 - 边界条件：只有一条插入指令 (原始数据)

**输入：**
```
1 1
1 1 2 3 4
2 1 1
```

**输出：**
```
1 2 3 4
```

### 测试用例 4 - 特殊情况：包含删除指令，且修改指令 (AI补充)

**输入：**
```
3 2
1 1 0 0 1
1 0 1 1 0
3
2 1 3
1 2 3
2 1 3
```

**输出：**
```
0 1 1 0
1 0 0 1
```

### 测试用例 5 - 基本测试：混合插入和删除 (AI补充)

**输入：**
```
4 2
2 1 0 0 1
2 0 1 1 0
1 2 0 0 2
3
2 1 4
2 2 4
```

**输出：**
```
2 0 0 2
0 2 2 0
```

## 题目信息

- **难度**: 困难
- **标签**: 数据结构, 线段树, 矩阵
