以下是整理好的第33次CCF计算机软件能力认证（CSP）模拟试题集合。

---

# 第33次CCF计算机软件能力认证

## 题目 1：词频统计 (Word Frequency Count)

**时间限制：** 1.0 秒
**空间限制：** 512 MiB

### 题目描述

在学习了文本处理后，小 P 对英语书中的 $n$ 篇文章进行了初步整理。 具体来说，小 P 将所有的英文单词都转化为了整数编号。假设这 $n$ 篇文章中共出现了 $m$ 个不同的单词，则把它们从 1 到 $m$ 进行编号。 这样，每篇文章就简化为了一个整数序列，其中每个数都在 1 到 $m$ 范围内。

现给出小 P 处理后的 $n$ 篇文章，对于每个单词 $i$（$1 \le i \le m$），试统计：

1. 单词 $i$ 出现在了多少篇文章中？
2. 单词 $i$ 在全部文章中总共出现了几次？

### 输入格式

从标准输入读入数据。
输入共 $n+1$ 行。
输入的第一行包含两个正整数 $n$ 和 $m$，分别表示文章篇数和单词编号上限。
输入的第 $i+1$ 行（$1 \le i \le n$）包含由空格分隔的若干整数， 其中第一个整数 $l_i$ 表示第 $i$ 篇文章的长度（单词个数）； 接下来 $l_i$ 个整数表示对应的整数序列，序列中每个整数均在 1 到 $m$ 范围内，各对应原文中的一个单词。

### 输出格式

输出到标准输出。
输出共 $m$ 行。
第 $i$ 行（$1 \le i \le m$）输出由空格分隔的两个整数 $x_i$ 和 $y_i$，表示共有 $x_i$ 篇文章包含单词 $i$，总计出现次数为 $y_i$。

### 样例输入

```text
4 3
5 1 2 3 2 1
1 1
3 2 2 2
2 3 2
```

### 样例输出

```text
2 3
3 6
2 2
```

### 样例解释

单词 2 在：

* 文章 1 中出现两次；
* 文章 3 中出现三次；
* 文章 4 中出现一次。
  因此 $x_2=3$、$y_2=6$。

### 子任务

全部的测试数据满足 $0 < n, m \le 100$，且每篇文章至少包含一个单词、最多不超过 100 个单词（$1 \le l_i \le 100$）。

---

## 题目 2：相似度计算 (Similarity Calculation)

**时间限制：** 1.0 秒
**空间限制：** 512 MiB

### 题目背景

两个集合的 Jaccard 相似度定义为：$Sim(A, B) = \frac{|A \cap B|}{|A \cup B|}$，即交集的大小除以并集的大小。

### 题目描述

除了进行简单的词频统计，小 P 还希望使用 Jaccard 相似度来评估两篇文章的相似性。
具体来说，每篇文章均由若干个英文单词组成，且英文单词仅包含“大小写英文字母”。 对于给定的两篇文章，小 P 首先需要提取出两者的单词集合 $A$ 和 $B$，即去掉各自重复的单词。 然后计算出：

1. $|A \cap B|$，即有多少个不同的单词同时出现在两篇文章中；
2. $|A \cup B|$，即两篇文章一共包含了多少个不同的单词。
   最后再将两者相除即可算出相似度。 需要注意，在整个计算过程中应当忽略英文字母大小写的区别，比如 `the`、`The` 和 `THE` 三者都应被视作同一个单词。

试编写程序帮助小 P 完成前两步，计算出 $|A \cap B|$ 和 $|A \cup B|$。

### 输入格式

从标准输入读入数据。
输入共三行。
输入的第一行包含两个正整数 $n$ 和 $m$，分别表示两篇文章的单词个数。
第二行包含空格分隔的 $n$ 个单词，表示第一篇文章；
第三行包含空格分隔的 $m$ 个单词，表示第二篇文章。

### 输出格式

输出到标准输出。
输出共两行。
第一行输出一个整数 $|A \cap B|$；
第二行输出一个整数 $|A \cup B|$。

### 样例 1

**输入：**

```text
3 2
The tHe thE
the THE
```

**输出：**

```text
1
1
```

**解释：** $A=B=A \cap B=A \cup B = \{\text{the}\}$

### 样例 2

**输入：**

```text
9 7
Par les soirs bleus dete jirai dans les sentiers
PICOTE PAR LES BLES FOULER LHERBE MENUE
```

**输出：**

```text
2
13
```

### 子任务

* 80% 的测试数据满足：$n, m \le 100$ 且所有字母均为小写；
* 全部的测试数据满足：$n, m \le 10^4$ 且每个单词最多包含 10 个字母。

---

## 题目 3：化学方程式配平 (Chemical Equation Balancing)

**时间限制：** 1.0 秒
**空间限制：** 512 MiB

### 题目描述

为了配平一个化学方程式，我们可以令方程式中各物质的系数为未知数，然后针对涉及的每一种元素，列出关于系数的方程，形成一个齐次线性方程组。如果方程组没有非零解，那么这个方程式是不可以配平的。反之，如果方程组有非零解，我们就可能得到一个配平的方程式。本题中，只需考虑非零解的存在性。

例如配平：$Al_2(SO_4)_3 + NH_3 \cdot H_2O \to Al(OH)_3 + (NH_4)_2SO_4$
假设系数为 $x_1, x_2, x_3, x_4$，对元素 Al, S, O, N, H 列方程组 $AX=0$。若系数矩阵 $A$ 的秩小于未知数个数，则存在非零解，即可以配平。

本题中，化学式已被化简为只包含小写字母和数字的字符串，不含括号。例如 `al2s3o12`。
请判断给定的化学方程式是否可以配平。

### 输入格式

从标准输入读入数据。
输入的第一行包含一个正整数 $n$，表示需要判断的化学方程式的个数。
接下来的 $n$ 行，每行描述了一个需要被配平的化学方程式。包含空格分隔的一个正整数 $m$ 和全部涉及物质的化学式。其中，$m$ 表示方程式中的物质个数；随后的 $m$ 个字符串，依次给出方程式中的反应物的化学式和生成物的化学式。

### 输出格式

输出到标准输出。
输出包含 $n$ 行，每行包含字母 `Y` 或 `N`，表示按题设方法，所给待配平化学方程式能否配平。

### 样例 1

**输入：**

```text
6
2 o2 o3
3 c1o1 c1o2 o2
2 n2o4 n1o2
4 cu1 h1n1o3 cu1n2o6 h2o1
4 al2s3o12 n1h5o1 al1o3h3 n2h8s1o4
4 c1o1 c1o2 o2 h2o1
```

**输出：**

```text
Y
Y
Y
N
Y
Y
```

### 子任务

* 20% 的数据：每个方程物质数 $\le 2$，元素种类 $\le 2$。
* 60% 的数据：每个方程物质数 $\le 3$，元素种类 $\le 3$。
* 100% 的数据：每个方程物质数 $\le 40$，元素种类 $\le 40$，$1 \le n \le 10$，化学式中原子个数 $\le 50$。
* 提示：利用高斯消元求系数矩阵的秩，若秩 < 未知数个数，则输出 Y，否则输出 N。评测环境不提供线性代数库。

---

## 题目 4：十滴水 (Ten Drops of Water)

**时间限制：** 3.0 秒
**空间限制：** 512 MiB

### 题目描述

十滴水游戏的一维版本。
网格 $1 \times c$，格子编号 $1$ 到 $c$。其中 $m$ 个格子里有 $1 \sim 4$ 滴水。
玩家进行 $n$ 次操作，每次选择一个有水的格子，水滴数加一。
**爆开规则**：若某格水滴数 $\ge 5$，该格水清空，同时向左右最近的有水格子的水滴数各加一。若有多个格子 $\ge 5$，最左侧先爆开。连锁反应直到所有格子水滴数 $< 5$。
小 C 想知道每次操作（及连锁反应）结束后，还有多少格子里有水。
题目保证每次操作的格子里都有水。

### 输入格式

从标准输入读入数据。
第一行三个整数 $c, m, n$。
接下来 $m$ 行每行两个整数 $x, w$，表示第 $x$ 格有 $w$ 滴水。
接下来 $n$ 行每行一个整数 $p$，表示操作第 $p$ 格。

### 输出格式

输出 $n$ 行，每行一个整数表示网格上有水的格子数量。

### 样例 1

**输入：**

```text
5 5 2
1 2
2 4
3 4
4 4
5 2
3
1
```

**输出：**

```text
2
1
```

### 子任务

* 子任务 1 (15分): $c, m \le 30$。
* 子任务 2 (10分): $c, m \le 3000$。
* 子任务 3 (15分): $c \le 10^9, m \le 3000$。
* 子任务 4 (15分): $c, m \le 3 \times 10^5$。
* 子任务 5 (15分): $c \le 10^9, m \le 3 \times 10^5$, 特殊性质（连锁反应中至多一个格子 $\ge 5$）。
* 子任务 6 (15分): $c \le 10^9, m \le 3 \times 10^5$，无特殊限制。
* $n \le 4m$。$1 \le w \le 4$。

---

## 题目 5：文件夹合并 (Folder Merging)

**时间限制：** 2.0 秒
**空间限制：** 512 MiB

### 题目描述

文件系统共有 $n$ 个文件夹，编号 1 到 $n$，构成树形结构，1 为根。每个文件夹 $i$ 直接存储 $d_i$ 字节数据。
操作：

1. **合并** (`1 x`): 将文件夹 $x$ 的所有子文件夹 $y$ 及其内容移动到 $x$，删除 $y$。即 $y$ 的子节点变成 $x$ 的子节点，$y$ 的数据加到 $x$ 上。**注意**：只合并直接子文件夹。合并后需输出 $x$ 的子文件夹数量和数据量。
2. **访问** (`2 z`): 从根节点出发，每次进入当前文件夹的一个子文件夹，直到到达 $z$。问最少经过多少个文件夹（包括根和 $z$）。即求根到 $z$ 的路径长度（节点数）。

### 输入格式

第一行 $n, m$。
第二行 $n-1$ 个整数 $f_2, \dots, f_n$，表示父文件夹编号。
第三行 $n$ 个整数 $d_1, \dots, d_n$。
接下来 $m$ 行，每行 `op val`。`op=1` 表示合并 $val$，`op=2` 表示访问 $val$。

### 输出格式

对于 `op=1`，输出两个整数：$x$ 的子文件夹数量和数据量。
对于 `op=2`，输出一个整数：路径长度。

### 样例 1

**输入：**

```text
4 6
1 1 3
100 0 200 300
2 1
2 4
1 1
2 4
1 1
1 1
```

**输出：**

```text
1
3
1 300
2
0 600
0 600
```

### 子任务

* $n \le 5 \times 10^5, m \le 3n$。
* 特殊性质 A: $f_i = i-1$ (链)。
* 特殊性质 B: $f_i = 1$ (菊花图)。
* 特殊性质 C: 合并操作中 $x=1$。
* 特殊性质 D: 无访问操作。
* 特殊性质 E: 无合并操作。
