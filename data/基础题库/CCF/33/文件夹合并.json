{
    "description": "给定树形文件系统（n 个文件夹，1 为根），每个文件夹 i 有数据量 d_i。支持两种操作：1) 合并文件夹 x 的所有直接子文件夹到 x（子文件夹的数据加到 x，子文件夹的子节点变为 x 的子节点），输出 x 的子文件夹数量和数据量；2) 访问文件夹 z，输出根到 z 的路径长度（节点数）。\n\n输入格式：第一行 n, m。第二行 n-1 个整数 f_2..f_n（父文件夹编号）。第三行 n 个整数 d_1..d_n（数据量）。接下来 m 行，每行 op val（op=1 合并 val，op=2 访问 val）。\n输出格式：对于每个操作，输出对应结果。",
    "difficulty": "medium",
    "id": "33_10556324979837770301",
    "options": [
    ],
    "referenceAnswer": "",
    "tags": [
        "树",
        "数据结构",
        "模拟"
    ],
    "testCases": [
        {
            "description": "基本测试：样例输入",
            "input": "4 6\n1 1 3\n100 0 200 300\n2 1\n2 4\n1 1\n2 4\n1 1\n1 1",
            "isAIGenerated": false,
            "output": "1\n3\n1 300\n2\n0 600\n0 600"
        },
        {
            "description": "基本测试：链状结构，合并后路径变短",
            "input": "3 3\n1 1\n10 20 30\n2 3\n1 1\n2 3",
            "isAIGenerated": false,
            "output": "3\n1 50\n2"
        },
        {
            "description": "边界条件：只有两个文件夹，合并后无子文件夹",
            "input": "2 2\n1\n5 10\n2 2\n1 1",
            "isAIGenerated": false,
            "output": "2\n0 15"
        },
        {
            "description": "边界条件：只有一个文件夹（根），访问路径长度为1，合并无效果",
            "input": "1 2\n\n100\n2 1\n1 1",
            "isAIGenerated": true,
            "output": "1\n0 100"
        },
        {
            "description": "特殊情况：菊花图，合并根后所有子节点被合并，但访问路径不变",
            "input": "5 4\n1 1 1 1\n1 2 3 4 5\n1 1\n2 5\n1 2\n2 5",
            "isAIGenerated": true,
            "output": "0 15\n5\n0 2\n5"
        },
        {
            "description": "特殊情况：连续合并，数据量始终为0",
            "input": "4 3\n1 2 3\n0 0 0 0\n1 3\n1 2\n1 1",
            "isAIGenerated": true,
            "output": "0 0\n0 0\n0 0"
        }
    ],
    "title": "文件夹合并",
    "type": "code"
}
